<!DOCTYPE html>
<html>
  <head>
    <title>NFC Sign In</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.6/css/selectize.min.css" integrity="sha512-zSutnLmqtlWVx0A5NdW8YwshpUETPzJ6YBAvb+bkE0QbVKopS0ACPjE6QY6F9aFPSowfiho+hgeQh095FRPj5A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="https://kit.fontawesome.com/b8646944c8.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.13.6/js/standalone/selectize.js" integrity="sha512-X6kWCt4NijyqM0ebb3vgEPE8jtUu9OGGXYGJ86bXTm3oH+oJ5+2UBvUw+uz+eEf3DcTTfJT4YQu/7F6MRV+wbA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  </head>
  <body>
    <style>
      .form-group{
        /*display: none;*/
      }
      input[type=date]{
        width: 200px;
      }
      .select-multiple{
        height: auto !important;
      }
      .tabs ul{
        margin:  0;
      }
      .content-tab{
        padding-top: 50px;
        padding-bottom: 50px;
      }
      #sign-in-content{
        padding: 20px;
      }
      .modal .box{
        text-align: center;
      }
      .submit-message{
        margin: 20px 0;
      }
      .fa-circle-check{
        color: yellowgreen;
      }
      .fa-circle-xmark{
        color: crimson;
      }
    </style>

    <!--Add buttons to initiate auth sequence and sign out-->
    <button id="authorize_button">Sign In To Authorize</button>
    <button id="signout_button">Sign Out</button>

    <div id="form-container" class="container" style="display: block;">
        <div class="content form-group">
            <section class="hero is-light">
                <div class="hero-head">
                    <div id="sign-in-content"></div>
                </div>

                <div class="hero-foot">
                    <div class="tabs is-boxed is-fullwidth is-large">
                        <ul>
                            <li id="tab-mfs" class="is-active tab-menu"><a>MFS</a></li>
                        </ul>
                    </div>
                </div>
            </section>
            <div id="content-tab-mfs" class="content-tab">
                <form id="form-mfs" method="POST">
                    <h4 class="title is-4">Main Applicant (Parent)</h3>
                    <!-- section main applicant -->
                    <div class="box">
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Salutation</label>
                                    <div class="select">
                                        <select name="parent_salutation">
                                            <option>Mr</option>
                                            <option>Ms</option>
                                            <option>Madm</option>
                                            <option>Mrs</option>
                                            <option>Dr</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Full Name</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="Full Name" name="parent_full_name" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Email</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="Email" name="parent_email" required>
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Mobile No.</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="Mobile" name="parent_phone" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">NRIC / FIN / Passport No.</label>
                            <div class="control">
                                <input class="input" type="text" placeholder="NRIC / FIN / Passport No." name="parent_identify_no" minlength="8">
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Relationship to Child</label>
                            <div class="select">
                                <select name="relationship_to_child">
                                    <option>Mother</option>
                                    <option>Father</option>
                                    <option>MSF Foster Parent</option>
                                    <option>Head, Children Home</option>
                                    <option>Legal Guardian</option>
                                    <option>Any Other Caregiver</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Postal Code</label>
                            <div class="control">
                                <input class="input" type="text" placeholder="" name="postal_code" required>
                            </div>
                        </div>

                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Street Name</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="street_name">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Building Name</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="building_name">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Block No.</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="block_no">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Floor No.</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="floor_no">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Unit No.</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="unit_no">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end section main applicant -->
                    
                    <h4 class="title is-4">Child</h3>
                    <!-- section child -->
                    <div class="box">
                        <div class="field">
                            <label class="label">Is the child born or unborn</label>
                            <div class="select" >
                                <select name="child_status" required>
                                    <option value="born">Born</option>
                                    <option value="unborn">Unborn</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Expected delivery date</label>
                            <div class="control">
                                <input class="input" type="date" placeholder="" name="expected_delivery_date">
                            </div>
                        </div>

                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Child's Full Name</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="child_full_name">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Child's Date of Birth</label>
                                    <div class="control">
                                        <input class="input" type="date" placeholder="" name="child_dob">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Child's Gender</label>
                                    <div class="control">
                                        <label class="radio">
                                            <input type="radio" name="child_gender" value="Male"> Male
                                        </label>
                                        <label class="radio">
                                            <input type="radio" name="child_gender" value="Female"> Female
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Child's Nationality</label>
                                    <div class="select">
                                        <select name="child_nationality">
                                            <option>Singapore Citizen</option>
                                            <option>Permanent Resident</option>
                                            <option>Foreigner</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Child's Birth Cert / FIN / Student Pass</label>
                            <div class="control">
                                <input class="input" type="text" placeholder="" name="child_identify_no" minlength="8">
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Preferred Start Date</label>
                            <div class="control">
                                <input class="input" type="date" placeholder="" name="start_date" required>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Service Level</label>
                            <div class="select">
                                <select name="service_level" required>
                                    <option>Infant (2 - 17 mths)</option>
                                    <option>PlayGroup (18 - 30 mths)</option>
                                    <option>N1 (3 yo)</option>
                                    <option>N2 (4 yo)</option>
                                    <option>K1 (5 yo)</option>
                                    <option>K2 (5 yo)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <!-- end section child -->

                    <h4 class="title is-4">Enquiry Details</h3>
                    <!-- section enquiry details -->
                    <div class="box">
                        <div class="field">
                            <label class="label">Lead Source</label>
                            <div class="select">
                                <select name="lead_source" required>
                                    <option>Website - MFS</option>
                                    <option>Website - LSH</option>
                                    <option>ECDA</option>
                                    <option>Internal Form - Hotline</option>
                                    <option>Internal Form - Walk-in</option>
                                    <option>Internal Form - Email</option>
                                    <option>Openhouse</option>
                                    <option>Webinar</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Programme Type</label>
                            <div class="select">
                                <select name="programme_type" required>
                                    <option>Full Day</option>
                                    <option>Half Day (AM)</option>
                                    <option>Half Day (PM)</option>
                                    <option>MFS - Flexi Care 1 (AM)</option>
                                    <option>MFS - Flexi Care 1 (PM)</option>
                                    <option>MFS - Flexi Care 1 (20Hrs)</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Preferred Centre (up to 3 - ranked in order)</label>
                            <div class="select select-multiple">
                                <select multiple class="select-centre" name="preferred_centre" style="width:300px;" required>
                                    <option value="ALC">Blk 491 Admiralty Link</option>
                                    <option value="AV2">Blk 302B Anchorvale Link</option>
                                    <option value="AV3">Blk 314A Anchorvale Link</option>
                                    <option value="AV5">Blk 332B Anchorvale Link</option>
                                    <option value="AVC">Blk 308C Anchorvale Road</option>
                                    <option value="MK5">Blk 331 Ang Mo Kio</option>
                                    <option value="MK6">Blk 209 Ang Mo Kio</option>
                                    <option value="MK8">Blk 229 Ang Mo Kio</option>
                                    <option value="MK2">Blk 329 Ang Mo Kio</option>
                                    <option value="AMK">Blk 343 Ang Mo Kio</option>
                                    <option value="MK7">Blk 571 Ang Mo Kio</option>
                                    <option value="MK4">Blk 601 Ang Mo Kio</option>
                                    <option value="MK3">Blk 541 Ang Mo Kio</option>
                                    <option value="BCC">Blk 419 Bedok North</option>
                                    <option value="BC2">Blk 503 Bedok North</option>
                                    <option value="BCC05">Blk 187 Bedok North</option>
                                    <option value="BC3">Blk 1 Bedok South</option>
                                    <option value="BS3">Blk 153 Bishan</option>
                                    <option value="BS2">Blk 236 Bishan</option>
                                    <option value="BSC">Blk 245 Bishan</option>
                                    <option value="BL4">Blk 197D Boon Lay</option>
                                    <option value="BL3">Blk 180B Boon Lay</option>
                                    <option value="BLC">Boon Lay Community Centre Level 4</option>
                                    <option value="BKC01">Blk 997 Buangkok Crescent</option>
                                    <option value="BBC01">Blk 260 Bukit Batok</option>
                                    <option value="BB2">Blk 291A Bukit Batok</option>
                                    <option value="BBC04">Blk 438 Bukit Batok West</option>
                                    <option value="BPC">Blk 235 Bukit Panjang</option>
                                    <option value="CRC02">Blk 120 Canberra Crescent</option>
                                    <option value="CRC">Blk 303 Canberra Road</option>
                                    <option value="CCR01">Blk 52 Cassia Crescent</option>
                                    <option value="CSC">Blk 54 Chin Swee Road</option>
                                    <option value="CCK03">Blk 815A Choa Chu Kang</option>
                                    <option value="CK2">Blk 208 Choa Chu Kang Central</option>
                                    <option value="CCK">Blk 212 Choa Chu Kang Central</option>
                                    <option value="CCK04">Blk 684A Choa Chu Kang Crescent</option>
                                    <option value="YTC">Blk 602 Choa Chu Kang</option>
                                    <option value="CIR01">Blk 82 Circuit Road</option>
                                    <option value="CCC">Blk 428 Clementi</option>
                                    <option value="CC3">Blk 375 Clementi</option>
                                    <option value="CV2">Blk 295A Compassvale Crescent</option>
                                    <option value="CV4">Blk 269 Compassvale Link</option>
                                    <option value="CV3">Blk 203D Compassvale Road</option>
                                    <option value="CVC">Blk 230 Compassvale Walk</option>
                                    <option value="EDC">Blk 126A Edgedale Plains</option>
                                    <option value="EDC02">Blk 682B Edgedale Plains</option>
                                    <option value="EFC02">Blk 119 Edgefield Plains</option>
                                    <option value="EFC">Blk 183 Edgefield Plains</option>
                                    <option value="FRC01">Blk 443A Fajar Road, Fajar Hills</option>
                                    <option value="SWC02">51 Fernvale Link (Large Childcare Centre at Sengkang West)</option>
                                    <option value="GRC">Blk 128 Geylang East</option>
                                    <option value="GCC">Guillemard Crescent</option>
                                    <option value="HRC">Blk 1 Haig Road</option>
                                    <option value="HVC01">Blk 51 Havelock Rd</option>
                                    <option value="HDC">Blk 106 Henderson Crescent</option>
                                    <option value="HLC">Blk 18A Holland Drive</option>
                                    <option value="HC2">Blk 170 Hougang</option>
                                    <option value="HCC">Blk 667 Hougang</option>
                                    <option value="HC3">Blk 528 Hougang</option>
                                    <option value="HC4">Blk 677 Hougang</option>
                                    <option value="HCC05">Blk 706 Hougang</option>
                                    <option value="PSC">Blk 950 Hougang</option>
                                    <option value="BM2">Blk 137 Jalan Bukit Merah</option>
                                    <option value="JSC">Blk 19 Jalan Sultan</option>
                                    <option value="JEC">Blk 211 Jurong East</option>
                                    <option value="JW7">Blk 681A Jurong West</option>
                                    <option value="JPC">Jurong Point Shopping Centre</option>
                                    <option value="JWC11">Blk 698C Jurong West</option>
                                    <option value="JW8">Blk 459 Jurong West</option>
                                    <option value="JW3">Blk 409 Jurong West</option>
                                    <option value="JWC">Blk 518 Jurong West</option>
                                    <option value="JW4">Blk 648C Jurong West</option>
                                    <option value="JW6">Blk 656C Jurong West</option>
                                    <option value="JW5">Blk 613 Jurong West</option>
                                    <option value="JWC10">10 Jurong West (Large Childcare Centre at Jurong West)</option>
                                    <option value="JW2">Blk 671A Jurong West</option>
                                    <option value="JW9">Blk 756 Jurong West</option>
                                    <option value="KBC">Blk 66 Kallang Bahru</option>
                                    <option value="JCC">Blk 333 Kang Ching Road</option>
                                    <option value="KKC">Blk 248 Kim Keat Link</option>
                                    <option value="PWC">80 Marine Parade Road</option>
                                    <option value="MTC">Blk 18 Marine Terrace</option>
                                    <option value="MNC">Blk 111 McNair Road</option>
                                    <option value="PR2">Blk 487 Pasir Ris</option>
                                    <option value="PRS">Blk 637 Pasir Ris</option>
                                    <option value="PR4">Blk 197 Pasir Ris</option>
                                    <option value="PR5">Blk 524C Pasir Ris</option>
                                    <option value="PR3">Blk 568 Pasir Ris</option>
                                    <option value="PTC">Blk 134 Potong Pasir</option>
                                    <option value="WWP">Waterway Point</option>
                                    <option value="PCC">Blk 166 Punggol Central</option>
                                    <option value="PCC07">Punggol Drive - Early Years Centre (0-4 years old)</option>
                                    <option value="PCC08">Blk 659A Punggol East - Early Years Centre (0-4 years old)</option>
                                    <option value="PC2">Blk 267A Punggol Field</option>
                                    <option value="PC4">Blk 208B Punggol Place</option>
                                    <option value="PC5">Blk 209A Punggol Place</option>
                                    <option value="PC3">Blk 306A Punggol Place</option>
                                    <option value="PCC10">6 New Punggol Road</option>
                                    <option value="RVC03">49 Rivervale Crescent (Large Childcare Centre at Rivervale Crescent)</option>
                                    <option value="RVC">Blk 153 Rivervale Crescent</option>
                                    <option value="RVC02">Blk 164 Rivervale Crescent</option>
                                    <option value="SKC">Blk 101 Rivervale Walk</option>
                                    <option value="SGC02">6 Segar Road</option>
                                    <option value="SGC">Blk 487 Segar Rd</option>
                                    <option value="SCC">Blk 331 Sembawang Close</option>
                                    <option value="SWC">50 Sengkang West Way</option>
                                    <option value="SJC">Blk 654 Senja Rd</option>
                                    <option value="SN3">Blk 306 Serangoon</option>
                                    <option value="SN2">Blk 219 Serangoon</option>
                                    <option value="SN4">Braddell Heights Community Hub</option>
                                    <option value="SNC">Blk 140 Serangoon North</option>
                                    <option value="TM2">Blk 135 Simei</option>
                                    <option value="EPC">Eastpoint Mall</option>
                                    <option value="SMC">Blk 82 Strathmore Avenue</option>
                                    <option value="PC6">Blk 312C Sumang Link</option>
                                    <option value="PCC09">Blk 322D Sumang Walk - Early Years Centre (0-4 years old)</option>
                                    <option value="TM3">Blk 803 Tampines</option>
                                    <option value="TM4">Blk 341 Tampines</option>
                                    <option value="TMC">Blk 487C Tampines</option>
                                    <option value="TJP">Blk 2 Tanjong Pagar Plaza</option>
                                    <option value="TBC">Blk 63 Telok Blangah Heights</option>
                                    <option value="TP5">Blk 236 Toa Payoh</option>
                                    <option value="TPC">Blk 192 Toa Payoh</option>
                                    <option value="TP2">Blk 55 Toa Payoh</option>
                                    <option value="TP3">Blk 14A Toa Payoh</option>
                                    <option value="TP4">Blk 219 Toa Payoh</option>
                                    <option value="WEL">Blk 507A Wellington Circle</option>
                                    <option value="WGC">Westgate</option>
                                    <option value="WPC">Blk 85 Whampoa Drive</option>
                                    <option value="WP2">Blk 49 Whampoa South</option>
                                    <option value="WGS01">Wisma Geylang Serai</option>
                                    <option value="WDC">Blk 347 Woodlands</option>
                                    <option value="WD6">Blk 678 Woodlands</option>
                                    <option value="WD4">Blk 742 Woodlands Circle</option>
                                    <option value="WD3">Blk 688C Woodlands</option>
                                    <option value="WDC07">Kampung Admiralty</option>
                                    <option value="WDC08">Blk 785E Woodlands Rise</option>
                                    <option value="WD2">Blk 406 Woodlands</option>
                                    <option value="WCC">Blk 848 Woodlands</option>
                                    <option value="YCC05">Blk 509B Yishun</option>
                                    <option value="YC4">Blk 423 Yishun</option>
                                    <option value="YCC">Blk 796A Yishun Ring</option>
                                    <option value="YC2">Blk 612 Yishun</option>
                                    <option value="YAC">505 Yung An Road</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Household Income</label>
                            <div class="select">
                                <select name="income" required>
                                    <option selected disabled>Choose income range</option>
                                    <option>2500 & Below</option>
                                    <option>2501 to 3000</option>
                                    <option>3001 to 3500</option>
                                    <option>3501 to 4000</option>
                                    <option>4001 to 4500</option>
                                    <option>4501 to 7500</option>
                                    <option>7501 to 10000</option>
                                    <option>10000 to 12500</option>
                                    <option>12501 to 15000</option>
                                    <option>15000 & above</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Referral Information</label>
                            <div class="control">
                                <input class="input" type="text" placeholder="" name="referral">
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Workplace Association</label>
                            <div class="select">
                                <select name="workplace_association">
                                    <option>LSH</option>
                                    <option>MFS</option>
                                    <option>NTUC</option>
                                </select>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Has a Centre Visit been conducted?</label>
                            <div class="control">
                                <label class="radio">
                                    <input type="radio" name="centre_visit_option" value="yes"> Yes
                                </label>
                                <label class="radio">
                                    <input type="radio" name="centre_visit_option" value="no"> No
                                </label>
                            </div>
                        </div>

                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Centre of Visit</label>
                                    <div class="control">
                                        <input class="input" type="text" placeholder="" name="centre_visit">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Date of Centre Visit</label>
                                    <div class="control">
                                        <input class="input" type="date" placeholder="" name="centre_visit_date">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Notes</label>
                            <div class="control">
                                <textarea class="textarea" placeholder="Your notes here" name="notes"></textarea>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Marketing Consent</label>
                            <div class="select select-multiple">
                                <select multiple class="select-consent" name="marketing_consent" style="width:300px;" required>
                                    <option>All</option>
                                    <option>Email</option>
                                    <option>SMS</option>
                                    <option>Phone</option>
                                    <option>App</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <!-- end section enquiry details -->

                    <div class="field">
                        <div class="control">
                            <button class="button is-success" type="submit" id="realButton">Submit MFS Application</button>
                            <button class="button is-success" disabled type="submit" id="loadingButton">Loading .....</button>
                        </div>
                    </div>
                    
                </form>
            </div>
        </div>
    </div>
    
    <div id="modal-submit" class="modal">
        <div class="modal-background"></div>

        <div class="modal-content">
            <div class="box">
                <span class="submit-icon"></span>
                <div class="submit-message"></div>
                <button class="button is-success btn-close">Close</button>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        /* exported gapiLoaded */
        /* exported gisLoaded */
        /* exported handleAuthClick */
        /* exported handleSignoutClick */

        // TODO(developer): Set to client ID and API key from the Developer Console
        const CLIENT_ID = '131782059606-38o5llf96b9f45kodikj3vftmshg1bjr.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyBswKtyy4lFEze5R8LRxLyQ_P88dAA_2Bs';


        // Discovery doc URL for APIs used by the quickstart
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/people/v1/rest';

        // Authorization scopes required by the API; multiple scopes can be
        // included, separated by spaces.
        const SCOPES = 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile';

        var token;
        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        
            document.getElementById('authorize_button').style.visibility = 'hidden';
            document.getElementById('signout_button').style.visibility = 'hidden';

        // function handleCredentialResponse(response) {
        //     console.log("Encoded JWT ID token: " + response.credential);
        //     handleAuthClick();
        // }
        // window.onload = function () {
        //   google.accounts.id.initialize({
        //     client_id: CLIENT_ID,
        //     callback: handleCredentialResponse
        //   });
        //   google.accounts.id.renderButton(
        //     document.getElementById("authorize_button"),
        //     { theme: "outline", size: "large" }  // customization attributes
        //   );
        // }

      /**
       * Callback after api.js is loaded.
       */
      function gapiLoaded() {
        gapi.load('client', intializeGapiClient);
      }

      /**
       * Callback after the API client is loaded. Loads the
       * discovery doc to initialize the API.
       */
      async function intializeGapiClient() {
        await gapi.client.init({
          apiKey: API_KEY,
          discoveryDocs: [DISCOVERY_DOC],
        });
        gapiInited = true;
        maybeEnableButtons();
      }

      /**
       * Callback after Google Identity Services are loaded.
       */
      function gisLoaded() {
        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id: CLIENT_ID,
          scope: SCOPES,
          callback: '', // defined later
        });
        gisInited = true;
        maybeEnableButtons();
      }

      /**
       * Enables user interaction after all libraries are loaded.
       */
      function maybeEnableButtons() {
        if (gapiInited && gisInited) {
            document.getElementById('authorize_button').style.visibility = 'visible';
        }
      }

    $( document ).ready(function() {
        if(sessionStorage.getItem("nfc-mfs-token")){
            if (gapiInited && gisInited) {
                displayItemsWhenSignedIn();
            }
        }

      /**
       *  Sign in the user upon button click.
       */

        function displayItemsWhenSignedIn(){
            document.getElementById('signout_button').style.visibility = 'visible';
            document.getElementById('authorize_button').innerText = 'Refresh';
            loadPerson();
        }
        function handleAuthClick() {
            tokenClient.callback = async (resp) => {
              if (resp.error !== undefined) {
                throw (resp);
              }
              displayItemsWhenSignedIn();
            };

            if (gapi.client.getToken() === null) {
              // Prompt the user to select a Google Account and ask for consent to share their data
              // when establishing a new session.
              tokenClient.requestAccessToken({prompt: 'consent'});
            } else {
              // Skip display of account chooser and consent dialog for an existing session.
              tokenClient.requestAccessToken({prompt: ''});
            }
        }

      /**
       *  Sign out the user upon button click.
       */
      function handleSignoutClick() {
        token = gapi.client.getToken();
        if (token !== null) {
          google.accounts.oauth2.revoke(token.access_token);
          gapi.client.setToken('');
          document.getElementById('content').innerText = '';
          document.getElementById('authorize_button').innerText = 'Authorize';
          document.getElementById('signout_button').style.visibility = 'hidden';

          sessionStorage.removeItem("nfc-mfs-token");
          sessionStorage.removeItem("nfc-mfs-name");
          sessionStorage.removeItem("nfc-mfs-email");
        }
      }

      function loadPerson() {
        token = gapi.client.getToken();
        sessionStorage.setItem("nfc-mfs-token", token.access_token);

        gapi.client.people.people.get({
          'resourceName': 'people/me',
          'requestMask.includeField': 'person.names,person.emailAddresses'
        }).then(function(resp) {
          var p = document.createElement('p');
          var name = resp.result.names[0].givenName;
          var email = resp.result.emailAddresses[0].value;

          sessionStorage.setItem("nfc-mfs-name", name);
          sessionStorage.setItem("nfc-mfs-email", email);


            document.getElementById('form-container').style.display = 'block';
            p.appendChild(document.createTextNode('Hello, ' + name +' (' + email + ')'));
            document.getElementById('sign-in-content').appendChild(p);

            $('input[name="parent_full_name"').val(name);
            $('input[name="parent_email').val(email);
        });
      }
            $("#authorize_button").click(function() {
                handleAuthClick();
            });

            $("#signout_button").click(function() {
                handleSignoutClick();
            });

            $("#loadingButton").hide();

            $(".select-centre").selectize({
              maxItems: 3,
            });

            $(".select-consent").selectize();

            $(".tab-menu").click(function() {
                if($(this).attr('id') == "tab-mfs")
                    openTab(event,'mfs');
                else
                    openTab(event,'lsh');
            })

            function openTab(evt, tabName) {
                $(".content-tab").hide();
                $(".tab-menu").removeClass("is-active");
                $("#tab-"+tabName).addClass("is-active");
                $("#content-tab-"+tabName).show();
            }

            function showModalSuccess(){
                $("#modal-submit").addClass("is-active");
                $(".submit-icon").html('<i class="fa-regular fa-circle-check fa-4x"></i>');
                $(".submit-message").html('Your data has been saved');
            }

            function showModalFailed(){
                $("#modal-submit").addClass("is-active");
                $(".submit-icon").html('<i class="fa-regular fa-circle-xmark fa-4x"></i>');
                $(".submit-message").html('Something wrong when saving your data');
            }

            $("#form-mfs").validate({
              // messages: {
              //   name: "Please specify your name",
              //   email: {
              //     required: "We need your email address to contact you",
              //     email: "Your email address must be in the format of name@domain.com"
              //   }
              // }
                submitHandler: function(form) {
                    //http://54.251.56.36
                    //https://nfc-api.onyxisland.com
                    // $.ajax({
                    //     url: 'http://54.251.56.36/api/v1/mfs-registration/mfs-register',
                    //     type: 'POST',
                    //     dataType: 'json',
                    //     crossOrigin: true,
                    //     headers: { 
                    //         'x-api-key': 'secret'
                    //     },
                    //     data: $("#form-mfs").serialize(),
                    //     success: function(data) {
                    //         console.log(data);
                    //         if(data.code == '200'){
                    //             showModalSuccess();
                    //         }
                    //         else{
                    //             showModalFailed();
                    //         }
                    //     }
                    // });

                    $.ajax({
                        url: 'https://nfc-api.onyxisland.com/api/v1/mfs-registration/mfs-register',
                        type: 'POST',
                        dataType: 'json',
                        crossOrigin: true,
                        headers: { 
                            'x-api-key': 'secret'
                        },
                        data: {
                            parent_salutation: $("select[name='parent_salutation']").val(),
                            parent_full_name: $("input[name='parent_full_name']").val(),
                            parent_email: $("input[name='parent_email']").val(),
                            parent_phone: $("input[name='parent_phone']").val(),
                            parent_identify_no: $("input[name='parent_identify_no']").val(),
                            relationship_to_child: $("select[name='relationship_to_child']").val(),
                            postal_code: $("input[name='postal_code']").val(),
                            street_name: $("input[name='street_name']").val(),
                            building_name: $("input[name='building_name']").val(),
                            block_no: $("input[name='block_no']").val(),
                            floor_no: $("input[name='floor_no']").val(),
                            unit_no: $("input[name='unit_no']").val(),
                            child_status: $("select[name='child_status']").val(),
                            expected_delivery_date: $("input[name='expected_delivery_date']").val(),
                            child_full_name: $("input[name='child_full_name']").val(),
                            child_dob: $("input[name='child_dob']").val(),
                            child_gender: $("input[name='child_gender']").val(),
                            child_nationality: $("select[name='child_nationality']").val(),
                            child_identify_no: $("input[name='child_identify_no']").val(),
                            start_date: $("input[name='start_date']").val(),
                            service_level: $("select[name='service_level']").val(),
                            lead_source: $("select[name='lead_source']").val(),
                            programme_type: $("select[name='programme_type']").val(),
                            preferred_centre: $("select[name='preferred_centre']").val(),
                            income: $("select[name='income']").val(),
                            referral: $("input[name='referral']").val(),
                            workplace_association: $("select[name='workplace_association']").val(),
                            centre_visit_option: $("input[name='centre_visit_option']").val(),
                            centre_visit: $("input[name='centre_visit']").val(),
                            centre_visit_date: $("input[name='centre_visit_date']").val(),
                            notes: $("textarea[name='notes']").val(),
                            marketing_consent: $("select[name='marketing_consent']").val().toString(),
                        },
                        success: function(data) {
                            console.log(data);
                            if(data.code == '200'){
                                    $("#loadingButton").hide();
                                    $("#realButton").show();
                                    showModalSuccess();
                                }
                                else{
                                    $("#loadingButton").hide();
                                    $("#realButton").show();
                                    showModalFailed();
                                }
                        }
                    });
                }
            });

            $(".modal-background, .btn-close").click(function() {
                $("#modal-submit").removeClass("is-active");
            })

        });

    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    
  </body>
</html>